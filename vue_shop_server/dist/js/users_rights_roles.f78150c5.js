"use strict";(self["webpackChunkvue_project"]=self["webpackChunkvue_project"]||[]).push([[241],{89:function(e,t){t.Z=(e,t)=>{const o=e.__vccOpts||e;for(const[l,r]of t)o[l]=r;return o}},4998:function(e,t,o){o.r(t),o.d(t,{default:function(){return n}});var l=o(311);function r(e,t,o,r,a,i){const s=(0,l.resolveComponent)("el-breadcrumb-item"),d=(0,l.resolveComponent)("el-breadcrumb"),n=(0,l.resolveComponent)("el-table-column"),c=(0,l.resolveComponent)("el-tag"),u=(0,l.resolveComponent)("el-table"),m=(0,l.resolveComponent)("el-card");return(0,l.openBlock)(),(0,l.createElementBlock)("div",null,[(0,l.createVNode)(d,{"separator-icon":a.ArrowRight},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(s,{to:{path:"/home/welcome"}},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)("首页")])),_:1}),(0,l.createVNode)(s,null,{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)("权限管理")])),_:1}),(0,l.createVNode)(s,null,{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)("权限列表")])),_:1})])),_:1},8,["separator-icon"]),(0,l.createVNode)(m,null,{default:(0,l.withCtx)((()=>[(0,l.createVNode)(u,{data:a.rightsList,border:"",stripe:""},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(n,{type:"index",label:"#"}),(0,l.createVNode)(n,{label:"权限名称",prop:"authName"}),(0,l.createVNode)(n,{label:"路径",prop:"path"}),(0,l.createVNode)(n,{label:"权限等级"},{default:(0,l.withCtx)((e=>["0"===e.row.level?((0,l.openBlock)(),(0,l.createBlock)(c,{key:0,type:"danger"},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)("一级")])),_:1})):(0,l.createCommentVNode)("",!0),"1"===e.row.level?((0,l.openBlock)(),(0,l.createBlock)(c,{key:1,type:"warning"},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)("二级")])),_:1})):(0,l.createCommentVNode)("",!0),"2"===e.row.level?((0,l.openBlock)(),(0,l.createBlock)(c,{key:2,type:"success"},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)("三级")])),_:1})):(0,l.createCommentVNode)("",!0)])),_:1})])),_:1},8,["data"])])),_:1})])}var a=o(3010),i={data(){return{ArrowRight:a.ArrowRight,rightsList:[]}},created(){this.getRightsList()},methods:{getRightsList(){this.$api.httpGet("rights/list",{showOuter:"error",error:["获取权限列表失败！"]}).then((e=>{this.rightsList=e.data}))}}},s=o(89);const d=(0,s.Z)(i,[["render",r]]);var n=d},1370:function(e,t,o){o.r(t),o.d(t,{default:function(){return m}});var l=o(311);const r={class:"dialog-footer"},a={class:"dialog-footer"},i={class:"dialog-footer"};function s(e,t,o,s,d,n){const c=(0,l.resolveComponent)("el-breadcrumb-item"),u=(0,l.resolveComponent)("el-breadcrumb"),m=(0,l.resolveComponent)("el-button"),h=(0,l.resolveComponent)("el-col"),p=(0,l.resolveComponent)("el-row"),g=(0,l.resolveComponent)("el-tag"),V=(0,l.resolveComponent)("CaretRight"),C=(0,l.resolveComponent)("el-icon"),w=(0,l.resolveComponent)("el-table-column"),f=(0,l.resolveComponent)("el-table"),N=(0,l.resolveComponent)("el-card"),x=(0,l.resolveComponent)("el-input"),b=(0,l.resolveComponent)("el-form-item"),R=(0,l.resolveComponent)("el-form"),_=(0,l.resolveComponent)("el-dialog"),k=(0,l.resolveComponent)("el-tree");return(0,l.openBlock)(),(0,l.createElementBlock)("div",null,[(0,l.createVNode)(u,{"separator-icon":d.ArrowRight},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(c,{to:{path:"/home/welcome"}},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)("首页")])),_:1}),(0,l.createVNode)(c,null,{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)("权限管理")])),_:1}),(0,l.createVNode)(c,null,{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)("角色列表")])),_:1})])),_:1},8,["separator-icon"]),(0,l.createVNode)(N,null,{default:(0,l.withCtx)((()=>[(0,l.createVNode)(p,null,{default:(0,l.withCtx)((()=>[(0,l.createVNode)(h,null,{default:(0,l.withCtx)((()=>[(0,l.createVNode)(m,{type:"primary",size:"large",onClick:t[0]||(t[0]=e=>n.showAddDialog())},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)("添加角色")])),_:1})])),_:1})])),_:1}),(0,l.createVNode)(f,{data:d.rolesList,border:"",stripe:"","row-key":"id"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(w,{type:"expand"},{default:(0,l.withCtx)((e=>[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(e.row.children,((t,o)=>((0,l.openBlock)(),(0,l.createBlock)(p,{class:(0,l.normalizeClass)([["vcenter","bdbottom",0===o?"bdtop":""],"role-expand"]),key:t.id},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(h,{span:5},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(g,{closable:"",type:"danger",onClose:o=>n.removeRightById(e.row,t.id,t.authName)},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)((0,l.toDisplayString)(t.authName),1)])),_:2},1032,["onClose"]),(0,l.createVNode)(C,null,{default:(0,l.withCtx)((()=>[(0,l.createVNode)(V)])),_:1})])),_:2},1024),(0,l.createVNode)(h,{span:19},{default:(0,l.withCtx)((()=>[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(t.children,((t,o)=>((0,l.openBlock)(),(0,l.createBlock)(p,{class:(0,l.normalizeClass)(["vcenter",0===o?"":"bdtop"]),key:t.id},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(h,{span:6},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(g,{closable:"",type:"warning",onClose:o=>n.removeRightById(e.row,t.id,t.authName)},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)((0,l.toDisplayString)(t.authName),1)])),_:2},1032,["onClose"]),(0,l.createVNode)(C,null,{default:(0,l.withCtx)((()=>[(0,l.createVNode)(V)])),_:1})])),_:2},1024),(0,l.createVNode)(h,{span:18},{default:(0,l.withCtx)((()=>[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(t.children,(t=>((0,l.openBlock)(),(0,l.createBlock)(g,{closable:"",type:"success",key:t.id,onClose:o=>n.removeRightById(e.row,t.id,t.authName)},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)((0,l.toDisplayString)(t.authName),1)])),_:2},1032,["onClose"])))),128))])),_:2},1024)])),_:2},1032,["class"])))),128))])),_:2},1024)])),_:2},1032,["class"])))),128))])),_:1}),(0,l.createVNode)(w,{type:"index",label:"#"}),(0,l.createVNode)(w,{label:"角色名称",prop:"roleName"}),(0,l.createVNode)(w,{label:"角色描述",prop:"roleDesc"}),(0,l.createVNode)(w,{label:"操作",width:"234px"},{default:(0,l.withCtx)((e=>[(0,l.createVNode)(m,{type:"primary",icon:d.Edit,size:"small",style:{padding:"5px 6px"},onClick:t=>n.showEditDialog(e.row.id)},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)("编辑")])),_:2},1032,["icon","onClick"]),(0,l.createVNode)(m,{type:"danger",icon:d.Delete,size:"small",style:{padding:"5px 6px"},onClick:t=>n.removeRoleById(e.row.id)},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)("删除")])),_:2},1032,["icon","onClick"]),(0,l.createVNode)(m,{type:"warning",icon:d.Setting,size:"small",style:{padding:"5px 6px"},onClick:t=>n.showSetRightsDialog(e.row)},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)("分配权限")])),_:2},1032,["icon","onClick"])])),_:1})])),_:1},8,["data"])])),_:1}),(0,l.createVNode)(_,{modelValue:d.addDialogVisible,"onUpdate:modelValue":t[4]||(t[4]=e=>d.addDialogVisible=e),title:"添加角色",width:"50%",onClose:n.addDialogClosed},{footer:(0,l.withCtx)((()=>[(0,l.createElementVNode)("span",r,[(0,l.createVNode)(m,{onClick:t[3]||(t[3]=e=>d.addDialogVisible=!1)},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)("取消")])),_:1}),(0,l.createVNode)(m,{type:"primary",onClick:n.addRole},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)(" 确认 ")])),_:1},8,["onClick"])])])),default:(0,l.withCtx)((()=>[(0,l.createVNode)(R,{model:d.addRoleForm,"label-width":"80px",rules:d.addRoleRules,ref:"addFormRef"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(b,{label:"角色名称",prop:"roleName"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(x,{modelValue:d.addRoleForm.roleName,"onUpdate:modelValue":t[1]||(t[1]=e=>d.addRoleForm.roleName=e)},null,8,["modelValue"])])),_:1}),(0,l.createVNode)(b,{label:"角色描述",prop:"roleDesc"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(x,{modelValue:d.addRoleForm.roleDesc,"onUpdate:modelValue":t[2]||(t[2]=e=>d.addRoleForm.roleDesc=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","onClose"]),(0,l.createVNode)(_,{modelValue:d.editDialogVisible,"onUpdate:modelValue":t[8]||(t[8]=e=>d.editDialogVisible=e),title:"修改角色信息",width:"50%",onClose:n.editDialogClosed},{footer:(0,l.withCtx)((()=>[(0,l.createElementVNode)("span",a,[(0,l.createVNode)(m,{onClick:t[7]||(t[7]=e=>d.editDialogVisible=!1)},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)("取消")])),_:1}),(0,l.createVNode)(m,{type:"primary",onClick:n.editRole},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)(" 确认 ")])),_:1},8,["onClick"])])])),default:(0,l.withCtx)((()=>[(0,l.createVNode)(R,{model:d.editRoleForm,"label-width":"80px",rules:d.editRoleRules,ref:"editFormRef"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(b,{label:"角色名称"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(x,{modelValue:d.editRoleForm.roleName,"onUpdate:modelValue":t[5]||(t[5]=e=>d.editRoleForm.roleName=e),disabled:""},null,8,["modelValue"])])),_:1}),(0,l.createVNode)(b,{label:"角色描述",prop:"roleDesc"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(x,{modelValue:d.editRoleForm.roleDesc,"onUpdate:modelValue":t[6]||(t[6]=e=>d.editRoleForm.roleDesc=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","onClose"]),(0,l.createVNode)(_,{modelValue:d.setRightsDialogVisible,"onUpdate:modelValue":t[10]||(t[10]=e=>d.setRightsDialogVisible=e),title:"分配权限",width:"50%",onClose:n.setRightsDialogClosed},{footer:(0,l.withCtx)((()=>[(0,l.createElementVNode)("span",i,[(0,l.createVNode)(m,{onClick:t[9]||(t[9]=e=>d.setRightsDialogVisible=!1)},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)("取消")])),_:1}),(0,l.createVNode)(m,{type:"primary",onClick:n.allotRights},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)("确认")])),_:1},8,["onClick"])])])),default:(0,l.withCtx)((()=>[(0,l.createVNode)(k,{data:d.rightsList,props:d.treeProps,"show-checkbox":"","node-key":"id","default-expand-all":"","default-checked-keys":d.defKeys,ref:"treeRef"},null,8,["data","props","default-checked-keys"])])),_:1},8,["modelValue","onClose"])])}o(7658);var d=o(3010),n={data(){return{ArrowRight:d.ArrowRight,Edit:d.Edit,Delete:d.Delete,Setting:d.Setting,rolesList:[],addDialogVisible:!1,addRoleForm:{},addRoleRules:{roleName:[{required:!0,message:"必须输入角色名称",trigger:"blur"},{min:2,message:"角色名称至少需要两个汉字",trigger:"blur"}],roleDesc:[{required:!0,message:"必须输入角色描述",trigger:"blur"},{min:2,message:"角色描述至少需要两个汉字",trigger:"blur"}]},editDialogVisible:!1,editRoleRules:{roleDesc:[{required:!0,message:"必须输入角色没描述",trigger:"blur"},{min:2,message:"角色描述至少需要两个汉字",trigger:"blur"}]},editRoleForm:{},editRoleBackup:{},setRightsDialogVisible:!1,rightsList:[],treeProps:{label:"authName",children:"children"},defKeys:[],setRightsRoleId:""}},created(){this.getRolesList()},methods:{getRolesList(){this.$api.httpGet("roles",{showOuter:"error",error:["获取角色列表失败！"]}).then((e=>{this.rolesList=e.data}))},showAddDialog(){this.addDialogVisible=!0},addDialogClosed(){this.$refs.addFormRef.resetFields()},addRole(){this.$api.httpPost("roles",this.addRoleForm,{showOuter:"error",success:["角色添加成功！"],error:["角色添加失败！"]},201).then((()=>{this.addDialogVisible=!1,this.getRolesList()}))},removeRightById(e,t,o){this.$confirm(`此操作将永久删除该角色的【${o}】权限，是否继续？`,"权限删除",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((()=>{this.$api.httpDelete(`roles/${e.id}/rights/${t}`,{showOuter:"error",error:["删除权限失败！"]}).then((t=>{e.children=t.data}))})).catch((()=>{this.$message({type:"info",message:"取消删除",duration:1200})}))},async showEditDialog(e){const t=await this.$api.httpGet("roles/"+e,{showOuter:"error",error:["获取角色信息失败！"]});this.editRoleForm=t.data,this.editRoleBackup={...t.data},this.editDialogVisible=!0},editDialogClosed(){this.$refs.editFormRef.resetFields()},async editRole(){if(this.editRoleForm.roleDesc===this.editRoleBackup.roleDesc)return this.$message({message:"角色信息未修改，更新取消",duration:1200});await this.$api.httpPut("roles/"+this.editRoleForm.roleId,this.editRoleForm,{success:["更新角色信息成功！"],error:["更新角色信息失败！"],showOuter:"error"});this.editDialogVisible=!1,this.getRolesList()},removeRoleById(e){this.$confirm("此操作将永久删除该角色，是否继续？","删除",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((()=>{this.$api.httpDelete("roles/"+e,{showOuter:"error",success:["删除角色成功！"],error:["删除角色失败！"]}).then((()=>{this.getRolesList()}))})).catch((()=>{this.$message({type:"info",message:"取消删除",duration:1200})}))},async showSetRightsDialog(e){this.setRightsRoleId=e.id;const t=await this.$api.httpGet("rights/tree",{showOuter:"error",error:["获取权限数据失败！"]});this.rightsList=t.data,this.getLeafKeys(e,this.defKeys),this.setRightsDialogVisible=!0},getLeafKeys(e,t){if(!e.children)return t.push(e.id);e.children.forEach((e=>this.getLeafKeys(e,t)))},setRightsDialogClosed(){this.defKeys=[]},allotRights(){const e=[...this.$refs.treeRef.getCheckedKeys(),...this.$refs.treeRef.getHalfCheckedKeys()],t=e.join(",");this.$api.httpPost(`roles/${this.setRightsRoleId}/rights`,{rids:t},{showOuter:"error",success:["分配权限成功！"],error:["分配权限失败！"]}).then((e=>{this.getRolesList(),this.setRightsDialogVisible=!1}))}}},c=o(89);const u=(0,c.Z)(n,[["render",s],["__scopeId","data-v-326b8334"]]);var m=u},4689:function(e,t,o){o.r(t),o.d(t,{default:function(){return h}});var l=o(311);const r={class:"mt-4"},a={class:"dialog-footer"},i={class:"dialog-footer"},s={class:"dialog-footer"};function d(e,t,o,d,n,c){const u=(0,l.resolveComponent)("el-breadcrumb-item"),m=(0,l.resolveComponent)("el-breadcrumb"),h=(0,l.resolveComponent)("el-button"),p=(0,l.resolveComponent)("el-input"),g=(0,l.resolveComponent)("el-col"),V=(0,l.resolveComponent)("el-row"),C=(0,l.resolveComponent)("el-table-column"),w=(0,l.resolveComponent)("el-switch"),f=(0,l.resolveComponent)("el-tooltip"),N=(0,l.resolveComponent)("el-table"),x=(0,l.resolveComponent)("el-pagination"),b=(0,l.resolveComponent)("el-card"),R=(0,l.resolveComponent)("el-form-item"),_=(0,l.resolveComponent)("el-form"),k=(0,l.resolveComponent)("el-dialog"),y=(0,l.resolveComponent)("el-option"),v=(0,l.resolveComponent)("el-select");return(0,l.openBlock)(),(0,l.createElementBlock)("div",null,[(0,l.createVNode)(m,{"separator-icon":n.ArrowRight},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(u,{to:{path:"/home/welcome"}},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)("首页")])),_:1}),(0,l.createVNode)(u,null,{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)("用户管理")])),_:1}),(0,l.createVNode)(u,null,{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)("用户列表")])),_:1})])),_:1},8,["separator-icon"]),(0,l.createVNode)(b,null,{default:(0,l.withCtx)((()=>[(0,l.createElementVNode)("div",r,[(0,l.createVNode)(V,{gutter:20},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(g,{span:8},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(p,{modelValue:n.queryInfo.query,"onUpdate:modelValue":t[0]||(t[0]=e=>n.queryInfo.query=e),placeholder:"请输入用户名",class:"input-with-select",clearable:"",onClear:c.getUserList},{append:(0,l.withCtx)((()=>[(0,l.createVNode)(h,{icon:n.Search,onClick:c.getUserList},null,8,["icon","onClick"])])),_:1},8,["modelValue","onClear"])])),_:1}),(0,l.createVNode)(g,{span:4},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(h,{type:"primary",onClick:t[1]||(t[1]=e=>n.addDialogVisible=!0)},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)("添加用户")])),_:1})])),_:1})])),_:1})]),(0,l.createVNode)(N,{data:n.userList,border:"",stripe:""},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(C,{label:"#",type:"index",width:"35"}),(0,l.createVNode)(C,{label:"姓名",prop:"username",width:"100"}),(0,l.createVNode)(C,{label:"邮箱",prop:"email",width:"140"}),(0,l.createVNode)(C,{label:"电话",prop:"mobile",width:"120"}),(0,l.createVNode)(C,{label:"角色",prop:"role_name",width:"90"}),(0,l.createVNode)(C,{label:"状态",width:"65"},{default:(0,l.withCtx)((e=>[(0,l.createVNode)(w,{modelValue:e.row.mg_state,"onUpdate:modelValue":t=>e.row.mg_state=t,onChange:t=>c.userStateChanged(e.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])])),_:1}),(0,l.createVNode)(C,{label:"操作","min-width":"160px"},{default:(0,l.withCtx)((e=>[(0,l.createVNode)(f,{content:"编辑",placement:"top",enterable:!1},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(h,{type:"primary",icon:n.Edit,size:"small",onClick:t=>c.showEditDialog(e.row.id)},null,8,["icon","onClick"])])),_:2},1024),(0,l.createVNode)(f,{content:"删除",placement:"top",enterable:!1},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(h,{type:"danger",icon:n.Delete,size:"small",onClick:t=>c.removeUserById(e.row.id)},null,8,["icon","onClick"])])),_:2},1024),(0,l.createVNode)(f,{content:"分配角色",placement:"top",enterable:!1},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(h,{type:"warning",icon:n.Setting,size:"small",onClick:t=>c.showSetRoleDialog(e.row)},null,8,["icon","onClick"])])),_:2},1024)])),_:1})])),_:1},8,["data"]),(0,l.createVNode)(x,{"current-page":n.queryInfo.pagenum,"onUpdate:currentPage":t[2]||(t[2]=e=>n.queryInfo.pagenum=e),"page-size":n.queryInfo.pagesize,"onUpdate:pageSize":t[3]||(t[3]=e=>n.queryInfo.pagesize=e),"page-sizes":[1,2,5,10],small:"",background:"",layout:"total, sizes, prev, pager, next, jumper",total:n.total,onSizeChange:c.handleSizeChange,onCurrentChange:c.handleCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])),_:1}),(0,l.createVNode)(k,{modelValue:n.addDialogVisible,"onUpdate:modelValue":t[10]||(t[10]=e=>n.addDialogVisible=e),title:"添加用户",width:"50%",onClose:c.addDialogClosed},{footer:(0,l.withCtx)((()=>[(0,l.createElementVNode)("span",a,[(0,l.createVNode)(h,{onClick:t[9]||(t[9]=e=>n.addDialogVisible=!1)},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)("取消")])),_:1}),(0,l.createVNode)(h,{type:"primary",onClick:c.addUser},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)(" 确认 ")])),_:1},8,["onClick"])])])),default:(0,l.withCtx)((()=>[(0,l.createVNode)(_,{model:n.addUserForm,"label-width":"120px",rules:n.addUserRules,ref:"addFormRef"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(R,{label:"用户名称",prop:"username"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(p,{modelValue:n.addUserForm.username,"onUpdate:modelValue":t[4]||(t[4]=e=>n.addUserForm.username=e)},null,8,["modelValue"])])),_:1}),(0,l.createVNode)(R,{label:"用户密码",prop:"password"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(p,{"show-password":"",modelValue:n.addUserForm.password,"onUpdate:modelValue":t[5]||(t[5]=e=>n.addUserForm.password=e)},null,8,["modelValue"])])),_:1}),(0,l.createVNode)(R,{label:"再次输入密码",prop:"checkPassword"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(p,{"show-password":"",modelValue:n.addUserForm.checkPassword,"onUpdate:modelValue":t[6]||(t[6]=e=>n.addUserForm.checkPassword=e)},null,8,["modelValue"])])),_:1}),(0,l.createVNode)(R,{label:"邮箱",prop:"email"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(p,{modelValue:n.addUserForm.email,"onUpdate:modelValue":t[7]||(t[7]=e=>n.addUserForm.email=e)},null,8,["modelValue"])])),_:1}),(0,l.createVNode)(R,{label:"电话号码",prop:"mobile"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(p,{modelValue:n.addUserForm.mobile,"onUpdate:modelValue":t[8]||(t[8]=e=>n.addUserForm.mobile=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","onClose"]),(0,l.createVNode)(k,{modelValue:n.editDialogVisible,"onUpdate:modelValue":t[15]||(t[15]=e=>n.editDialogVisible=e),title:"修改用户信息",width:"50%",onClose:c.editDialogClosed},{footer:(0,l.withCtx)((()=>[(0,l.createElementVNode)("span",i,[(0,l.createVNode)(h,{onClick:t[14]||(t[14]=e=>n.editDialogVisible=!1)},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)("取消")])),_:1}),(0,l.createVNode)(h,{type:"primary",onClick:c.editUser},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)(" 确认 ")])),_:1},8,["onClick"])])])),default:(0,l.withCtx)((()=>[(0,l.createVNode)(_,{model:n.editUserForm,"label-width":"120px",rules:n.editUserRules,ref:"editFormRef"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(R,{label:"用户名称"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(p,{modelValue:n.editUserForm.username,"onUpdate:modelValue":t[11]||(t[11]=e=>n.editUserForm.username=e),disabled:""},null,8,["modelValue"])])),_:1}),(0,l.createVNode)(R,{label:"邮箱",prop:"email"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(p,{modelValue:n.editUserForm.email,"onUpdate:modelValue":t[12]||(t[12]=e=>n.editUserForm.email=e)},null,8,["modelValue"])])),_:1}),(0,l.createVNode)(R,{label:"电话号码",prop:"mobile"},{default:(0,l.withCtx)((()=>[(0,l.createVNode)(p,{modelValue:n.editUserForm.mobile,"onUpdate:modelValue":t[13]||(t[13]=e=>n.editUserForm.mobile=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","onClose"]),(0,l.createVNode)(k,{modelValue:n.setRoleDialogVisible,"onUpdate:modelValue":t[18]||(t[18]=e=>n.setRoleDialogVisible=e),title:"分配角色",width:"50%",onClose:c.setRoleDialogClosed},{footer:(0,l.withCtx)((()=>[(0,l.createElementVNode)("span",s,[(0,l.createVNode)(h,{onClick:t[17]||(t[17]=e=>n.setRoleDialogVisible=!1)},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)("取消")])),_:1}),(0,l.createVNode)(h,{type:"primary",onClick:c.setRole},{default:(0,l.withCtx)((()=>[(0,l.createTextVNode)(" 确认 ")])),_:1},8,["onClick"])])])),default:(0,l.withCtx)((()=>[(0,l.createElementVNode)("div",null,[(0,l.createElementVNode)("p",null,"当前用户："+(0,l.toDisplayString)(n.userInfo.username),1),(0,l.createElementVNode)("p",null,"用户角色："+(0,l.toDisplayString)(n.userInfo.role_name),1),(0,l.createElementVNode)("p",null,[(0,l.createTextVNode)("分配新角色： "),(0,l.createVNode)(v,{modelValue:n.selectedRoleId,"onUpdate:modelValue":t[16]||(t[16]=e=>n.selectedRoleId=e),placeholder:"选择角色"},{default:(0,l.withCtx)((()=>[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(n.rolesList,(e=>((0,l.openBlock)(),(0,l.createBlock)(y,{key:e.id,label:e.roleName,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])])])),_:1},8,["modelValue","onClose"])])}o(1703);var n=o(3010),c={data(){const e=(e,t,o)=>{const l=/^(0|86|17951)?(13[0-9]|15[012356789]|17[678]|18[0-9]|14[57])[0-9]{8}$/;l.test(t)||""==t?o():o(new Error("请输入正确的电话号码"))},t=(e,t,o)=>{var l=/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(\.[a-zA-Z0-9_-])+/,r=/^([a-zA-Z]|[0-9])(\w|\-)+@[a-zA-Z0-9]+\.([a-zA-Z]{2,4})$/;!l.test(t)&&""!=t||!r.test(t)&&""!=t?o(new Error("请输入有效邮箱格式！")):o()},o=(e,t,o)=>{if(""!==t&&""!==this.addUserForm.checkPassword)return this.$refs.addFormRef.validateField("checkPassword",(()=>null));o()},l=(e,t,o)=>{if(""!==t&&t!==this.addUserForm.password)return o(new Error("两次输入的密码不一致"));o()};return{ArrowRight:n.ArrowRight,Search:n.Search,Edit:n.Edit,Delete:n.Delete,Setting:n.Setting,queryInfo:{query:"",pagenum:1,pagesize:2},total:0,userList:[],addDialogVisible:!1,addUserForm:{username:"bcd123456",password:"bcd123456",checkPassword:"bcd123456",email:"bcd@123456.com",mobile:"13612345678"},addUserRules:{username:[{required:!0,message:"请输入登录名称",trigger:"blur"},{min:3,max:10,message:"用户名长度 3 到 10 个字符",trigger:"blur"}],password:[{required:!0,message:"请输入登录密码",trigger:"blur"},{min:6,max:20,message:"密码长度 6 到 20 个字符",trigger:"blur"},{validator:o,trigger:"blur"}],checkPassword:[{required:!0,message:"请再次输入登录密码",trigger:"blur"},{min:6,max:20,message:"密码长度 6 到 20 个字符",trigger:"blur"},{validator:l,trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{validator:t,trigger:"blur"}],mobile:[{required:!0,message:"请输入电话号码",trigger:"blur"},{validator:e,trigger:"blur"}]},editDialogVisible:!1,editUserForm:{},editUserRules:{email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{validator:t,trigger:"blur"}],mobile:[{required:!0,message:"请输入电话号码",trigger:"blur"},{validator:e,trigger:"blur"}]},editUserFormBackup:{},userInfo:{},setRoleDialogVisible:!1,rolesList:[],setRoleTreeProps:{label:"roleName",children:"children"},selectedRoleId:""}},created(){this.getUserList()},methods:{async getUserList(){const{data:e}=await this.$http.get("users",{params:this.queryInfo});if(200!==e.meta.status)return this.$message.error({message:"获取用户名列表失败",duration:1200});this.total=e.data.total,this.userList=e.data.users},handleSizeChange(e){this.queryInfo.pagesize=e,this.getUserList()},handleCurrentChange(e){this.queryInfo.pagenum=e,this.getUserList()},async userStateChanged(e){const{data:t}=await this.$http.put(`users/${e.id}/state/${e.mg_state}`);200!==t.meta.status&&(this.$message.error({message:"更新用户状态失败！",duration:1200}),e.mg_state=!e.mg_state),this.$message.success({message:"更新用户状态成功！",duration:1200})},addDialogClosed(){this.$refs.addFormRef.resetFields()},addUser(){this.$refs.addFormRef.validate((async e=>{if(!e)return;const{data:t}=await this.$http.post("users",this.addUserForm);if(201!==t.meta.status)return this.$message.error({message:"添加用户失败！"+t.meta.msg,duration:1200});this.$message.success({message:"添加用户成功！",duration:1200}),this.addDialogVisible=!1,this.getUserList()}))},showEditDialog(e){this.$api.httpGet(`users/${e}`,{error:["查询用户信息失败！"],showOuter:"error"}).then((e=>{this.editUserForm=e.data,this.editUserFormBackup={...e.data},this.editDialogVisible=!0}))},editDialogClosed(){this.$refs.editFormRef.resetFields()},editUser(){this.$refs.editFormRef.validate((e=>{if(e)return this.editUserForm.email===this.editUserFormBackup.email&&this.editUserForm.mobile===this.editUserFormBackup.mobile?this.$message({message:"用户信息未改动",duration:1200}):void this.$api.httpPut("users/"+this.editUserForm.id,this.editUserForm,{error:["更新用户信息失败！"],showOuter:"error"}).then((e=>{this.editDialogVisible=!1,this.getUserList(),this.$message.success({message:"更新用户信息成功",duration:1200})}))}))},removeUserById(e){this.$confirm("此操作将永久删除该用户，是否继续？","删除",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((()=>{this.$api.httpDelete("users/"+e,{showOuter:"error",success:["删除用户成功！"],error:["删除用户失败！"]}).then((()=>{this.getUserList()}))})).catch((()=>{this.$message({type:"info",message:"取消删除",duration:1200})}))},async showSetRoleDialog(e){this.userInfo=e;const{data:t}=await this.$api.httpGet("roles",{showOuter:"error",error:["角色列表获取失败！"]});this.rolesList=t,this.setRoleDialogVisible=!0},setRole(){if(!this.selectedRoleId)return this.$message({message:"您没有为用户指定角色",duration:1200});this.$api.httpPut(`users/${this.userInfo.id}/role`,{rid:this.selectedRoleId},{error:["分配用户角色失败"]}).then((()=>{this.setRoleDialogVisible=!1,this.getUserList()}))},setRoleDialogClosed(){this.selectedRoleId="",this.userInfo={}}}},u=o(89);const m=(0,u.Z)(c,[["render",d]]);var h=m}}]);
//# sourceMappingURL=users_rights_roles.f78150c5.js.map