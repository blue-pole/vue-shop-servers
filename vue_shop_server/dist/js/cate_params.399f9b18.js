"use strict";(self["webpackChunkvue_project"]=self["webpackChunkvue_project"]||[]).push([[955],{89:function(e,t){t.Z=(e,t)=>{const a=e.__vccOpts||e;for(const[o,l]of t)a[o]=l;return a}},9620:function(e,t,a){a.r(t),a.d(t,{default:function(){return m}});var o=a(311);const l={class:"dialog-footer"},r={class:"dialog-footer"};function i(e,t,a,i,d,s){const n=(0,o.resolveComponent)("el-breadcrumb-item"),c=(0,o.resolveComponent)("el-breadcrumb"),m=(0,o.resolveComponent)("el-button"),h=(0,o.resolveComponent)("el-col"),u=(0,o.resolveComponent)("el-row"),C=(0,o.resolveComponent)("el-table-column"),p=(0,o.resolveComponent)("CircleCheckFilled"),V=(0,o.resolveComponent)("CircleCloseFilled"),g=(0,o.resolveComponent)("el-tag"),w=(0,o.resolveComponent)("el-table"),f=(0,o.resolveComponent)("el-pagination"),_=(0,o.resolveComponent)("el-card"),x=(0,o.resolveComponent)("el-input"),N=(0,o.resolveComponent)("el-form-item"),b=(0,o.resolveComponent)("el-cascader"),y=(0,o.resolveComponent)("el-form"),v=(0,o.resolveComponent)("el-dialog");return(0,o.openBlock)(),(0,o.createElementBlock)("div",null,[(0,o.createVNode)(c,{"separator-icon":d.ArrowRight},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(n,{to:{path:"/home/welcome"}},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)("首页")])),_:1}),(0,o.createVNode)(n,null,{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)("商品管理")])),_:1}),(0,o.createVNode)(n,null,{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)("商品分类")])),_:1})])),_:1},8,["separator-icon"]),(0,o.createVNode)(_,null,{default:(0,o.withCtx)((()=>[(0,o.createVNode)(u,null,{default:(0,o.withCtx)((()=>[(0,o.createVNode)(h,null,{default:(0,o.withCtx)((()=>[(0,o.createVNode)(m,{type:"primary",onClick:s.showAddCateDialog},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)("添加分类")])),_:1},8,["onClick"])])),_:1})])),_:1}),(0,o.createVNode)(w,{data:d.cateList,border:"","row-key":"cat_id",lazy:"",load:s.lazyLoad},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(C,{type:"index",width:"72px",label:"#",index:s.getIndex},null,8,["index"]),(0,o.createVNode)(C,{label:"分类名称",prop:"cat_name","min-width":"174px"}),(0,o.createVNode)(C,{label:"是否有效",width:"73px"},{default:(0,o.withCtx)((e=>[e.row.cat_deleted?((0,o.openBlock)(),(0,o.createBlock)(p,{key:0,class:"icons success"})):((0,o.openBlock)(),(0,o.createBlock)(V,{key:1,class:"icons error"}))])),_:1}),(0,o.createVNode)(C,{label:"排序"},{default:(0,o.withCtx)((e=>[0===e.row.cat_level?((0,o.openBlock)(),(0,o.createBlock)(g,{key:0,size:"small"},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)("一级")])),_:1})):(0,o.createCommentVNode)("",!0),1===e.row.cat_level?((0,o.openBlock)(),(0,o.createBlock)(g,{key:1,size:"small",type:"success"},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)("二级")])),_:1})):(0,o.createCommentVNode)("",!0),2===e.row.cat_level?((0,o.openBlock)(),(0,o.createBlock)(g,{key:2,size:"small",type:"warning"},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)("三级")])),_:1})):(0,o.createCommentVNode)("",!0)])),_:1}),(0,o.createVNode)(C,{label:"操作","min-width":"182px"},{default:(0,o.withCtx)((e=>[(0,o.createVNode)(m,{type:"primary",icon:d.Edit,size:"small",onClick:t=>s.showSetCateDialog(e.row.cat_id)},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)("编辑")])),_:2},1032,["icon","onClick"]),(0,o.createVNode)(m,{type:"danger",icon:d.Delete,size:"small",onClick:t=>s.removeCateById(e.row.cat_id)},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)("删除")])),_:2},1032,["icon","onClick"])])),_:1})])),_:1},8,["data","load"]),(0,o.createVNode)(f,{"current-page":d.queryInfo.pagenum,"onUpdate:currentPage":t[0]||(t[0]=e=>d.queryInfo.pagenum=e),"page-size":d.queryInfo.pagesize,"onUpdate:pageSize":t[1]||(t[1]=e=>d.queryInfo.pagesize=e),"page-sizes":[5,10,20,50,100],small:"",background:"",layout:"total, sizes, prev, pager, next, jumper",total:d.total,onSizeChange:s.handleSizeChange,onCurrentChange:s.handleCurrentChange},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])])),_:1}),(0,o.createVNode)(v,{title:"添加分类",width:"50%",modelValue:d.addCateDialogVisible,"onUpdate:modelValue":t[5]||(t[5]=e=>d.addCateDialogVisible=e),onClose:s.addCateDialogClosed},{footer:(0,o.withCtx)((()=>[(0,o.createElementVNode)("span",l,[(0,o.createVNode)(m,{onClick:t[4]||(t[4]=e=>d.addCateDialogVisible=!1)},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)("取消")])),_:1}),(0,o.createVNode)(m,{type:"primary",onClick:s.addCate},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)(" 确认 ")])),_:1},8,["onClick"])])])),default:(0,o.withCtx)((()=>[(0,o.createVNode)(y,{model:d.addCateForm,"label-width":"100px",rules:d.addCateFormRules,ref:"addCateFormRef"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(N,{label:"分类名称：",prop:"cat_name"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(x,{modelValue:d.addCateForm.cat_name,"onUpdate:modelValue":t[2]||(t[2]=e=>d.addCateForm.cat_name=e)},null,8,["modelValue"])])),_:1}),(0,o.createVNode)(N,{label:"父级分类："},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(b,{style:{width:"100%"},modelValue:d.selectedParentCateIds,"onUpdate:modelValue":t[3]||(t[3]=e=>d.selectedParentCateIds=e),options:d.parentCateList,props:d.cascaderProps,onChange:s.parentCateChanged,clearable:""},null,8,["modelValue","options","props","onChange"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","onClose"]),(0,o.createVNode)(v,{title:"编辑分类",width:"50%",modelValue:d.setCateDialogVisible,"onUpdate:modelValue":t[8]||(t[8]=e=>d.setCateDialogVisible=e),onClose:s.setCateDialogClosed},{footer:(0,o.withCtx)((()=>[(0,o.createElementVNode)("span",r,[(0,o.createVNode)(m,{onClick:t[7]||(t[7]=e=>d.setCateDialogVisible=!1)},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)("取消")])),_:1}),(0,o.createVNode)(m,{type:"primary",onClick:s.setCate},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)(" 确认 ")])),_:1},8,["onClick"])])])),default:(0,o.withCtx)((()=>[(0,o.createVNode)(y,{model:d.setCateForm,"label-width":"100px",rules:d.setCateFormRules,ref:"setCateFormRef"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(N,{label:"分类名称：",prop:"cat_name"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(x,{modelValue:d.setCateForm.cat_name,"onUpdate:modelValue":t[6]||(t[6]=e=>d.setCateForm.cat_name=e)},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","onClose"])])}a(7658);var d=a(3010),s={data(){return{ArrowRight:d.ArrowRight,CircleCheckFilled:d.CircleCheckFilled,CircleCloseFilled:d.CircleCloseFilled,Edit:d.Edit,Delete:d.Delete,Setting:d.Setting,cateList:[],queryInfo:{type:3,pagenum:1,pagesize:5},total:0,indexList:[],addCateDialogVisible:!1,addCateForm:{cat_pid:0,cat_name:"",cat_level:0},addCateFormRules:{cat_name:[{required:!0,message:"请输入分类名称",triggle:"blur"}]},parentCateList:[],cascaderProps:{value:"cat_id",label:"cat_name",children:"children",expandTrigger:"hover",checkStrictly:!0},selectedParentCateIds:[],setCateDialogVisible:!1,setCateForm:{cat_name:""},setCateFormBackup:{cat_name:""},setCateFormRules:{cat_name:[{required:!0,message:"请输入分类名称",triggle:"blur"}]}}},created(){this.getCateList()},methods:{async getCateList(){const e=await this.$api.httpGet("categories",{showOuter:"error",error:["商品分类数据获取失败!"]},200,{params:this.queryInfo});this.cateList=e.data.result,this.total=e.data.total,this.indexList=[],this.getTableIndex(this.cateList,this.indexList,"")},getTableIndex(e,t,a){for(let o=0;o<e.length;o++)if(t.push(a+(o+1)),e[o].children){let a=t[t.length-1]+"-";this.getTableIndex(e[o].children,t,a)}},getIndex(e){return this.indexList[e]},lazyLoad(e,t,a){setTimeout((()=>{a(e.children)}),0)},handleSizeChange(e){this.queryInfo.pagesize=e,this.getCateList()},handleCurrentChange(e){this.queryInfo.pagenum=e,this.getCateList()},showAddCateDialog(){this.getParentCateList(),this.addCateDialogVisible=!0},async getParentCateList(){const e=await this.$api.httpGet("categories",{showOuter:"error",error:["获取商品分类列表失败！"]},200,{params:{type:2}});this.parentCateList=e.data},parentCateChanged(){!Array.isArray(this.selectedParentCateIds)&&(this.selectedParentCateIds=[]),this.selectedParentCateIds.length>0?(this.addCateForm.cat_level=this.selectedParentCateIds.length,this.addCateForm.cat_pid=this.selectedParentCateIds[this.selectedParentCateIds.length-1]):(this.addCateForm.cat_level=0,this.addCateForm.cat_pid=0)},addCate(){this.$refs.addCateFormRef.validate((e=>{e&&this.$api.httpPost("categories",this.addCateForm,{error:["分类添加失败！"]},201).then((()=>{this.getCateList(),this.addCateDialogVisible=!1}))}))},addCateDialogClosed(){this.$refs.addCateFormRef.resetFields(),this.selectedParentCateIds=[],this.addCateForm.cat_level=0,this.addCateForm.cat_pid=0},async showSetCateDialog(e){await this.getCateById(e),this.setCateDialogVisible=!0},async getCateById(e){await this.$api.httpGet("categories/"+e,{showOuter:"error",error:["查询分类信息失败！"]}).then((e=>{this.setCateForm=e.data,this.setCateFormBackup={...e.data}}))},setCateDialogClosed(){this.$refs.setCateFormRef.resetFields(),this.setCateForm.cat_name=""},setCate(){this.$refs.setCateFormRef.validate((e=>{if(e)return this.setCateForm.cat_name===this.setCateFormBackup.cat_name?this.$message({message:"分类名称未修改",duration:1200}):void this.$api.httpPut("categories/"+this.setCateForm.cat_id,this.setCateForm,{error:["分类添加失败！"]}).then((()=>{this.getCateList(),this.setCateDialogVisible=!1}))}))},removeCateById(e){this.$confirm("此操作将永久删除该商品分类，是否继续？","删除",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then((()=>{this.$api.httpDelete("categories/"+e,{error:["删除失败！"]}).then((()=>{this.getCateList()}))})).catch((()=>{this.$message({message:"删除取消",duration:1200})}))}}},n=a(89);const c=(0,n.Z)(s,[["render",i],["__scopeId","data-v-317c796e"]]);var m=c},555:function(e,t,a){a.r(t),a.d(t,{default:function(){return C}});var o=a(311);const l=e=>((0,o.pushScopeId)("data-v-4f976997"),e=e(),(0,o.popScopeId)(),e),r={class:"params-view"},i=l((()=>(0,o.createElementVNode)("span",null,"选择商品分类：",-1))),d={class:"dialog-footer"},s={class:"dialog-footer"};function n(e,t,a,l,n,c){const m=(0,o.resolveComponent)("el-breadcrumb-item"),h=(0,o.resolveComponent)("el-breadcrumb"),u=(0,o.resolveComponent)("el-alert"),C=(0,o.resolveComponent)("el-cascader"),p=(0,o.resolveComponent)("el-col"),V=(0,o.resolveComponent)("el-row"),g=(0,o.resolveComponent)("el-button"),w=(0,o.resolveComponent)("el-tag"),f=(0,o.resolveComponent)("el-input"),_=(0,o.resolveComponent)("el-table-column"),x=(0,o.resolveComponent)("el-table"),N=(0,o.resolveComponent)("el-tab-pane"),b=(0,o.resolveComponent)("el-tabs"),y=(0,o.resolveComponent)("el-card"),v=(0,o.resolveComponent)("el-form-item"),k=(0,o.resolveComponent)("el-form"),F=(0,o.resolveComponent)("el-dialog");return(0,o.openBlock)(),(0,o.createElementBlock)("div",r,[(0,o.createVNode)(h,{"separator-icon":n.ArrowRight},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(m,{to:{path:"/home/welcome"}},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)("首页")])),_:1}),(0,o.createVNode)(m,null,{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)("商品管理")])),_:1}),(0,o.createVNode)(m,null,{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)("分类参数")])),_:1})])),_:1},8,["separator-icon"]),(0,o.createVNode)(y,null,{default:(0,o.withCtx)((()=>[(0,o.createVNode)(u,{title:"注意：只允许为第三级分类设置相关参数！",type:"warning",closable:!1,"show-icon":""}),(0,o.createVNode)(V,{class:"cat-opt"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(p,null,{default:(0,o.withCtx)((()=>[i,(0,o.createVNode)(C,{modelValue:n.selectedCateIds,"onUpdate:modelValue":t[0]||(t[0]=e=>n.selectedCateIds=e),options:n.cateList,props:n.cascadeProps,onChange:c.handleChange},null,8,["modelValue","options","props","onChange"])])),_:1})])),_:1}),(0,o.createVNode)(b,{modelValue:n.activeName,"onUpdate:modelValue":t[1]||(t[1]=e=>n.activeName=e),onTabChange:c.handleTabChange},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(N,{label:"动态参数",name:"many"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(g,{type:"primary",disabled:3!==n.selectedCateIds.length,onClick:c.showAddParamsdialog},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)("添加参数")])),_:1},8,["disabled","onClick"]),(0,o.createVNode)(x,{data:n.manyTableData,border:"",stripe:"","row-key":"attr_id"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(_,{type:"expand",width:"40px"},{default:(0,o.withCtx)((e=>[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(e.row.attr_vals,((t,a)=>((0,o.openBlock)(),(0,o.createBlock)(w,{class:"tableTag",key:a,closable:"",onClose:t=>c.handleClose(a,e.row)},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(t),1)])),_:2},1032,["onClose"])))),128)),e.row.inputVisible?((0,o.openBlock)(),(0,o.createBlock)(f,{key:0,ref:"inputRef",modelValue:e.row.inputValue,"onUpdate:modelValue":t=>e.row.inputValue=t,class:"new-tag tableTag",size:"small",onKeyup:(0,o.withKeys)((t=>c.handleInputConfirm(e.row)),["enter"]),onBlur:t=>c.handleInputConfirm(e.row)},null,8,["modelValue","onUpdate:modelValue","onKeyup","onBlur"])):((0,o.openBlock)(),(0,o.createBlock)(g,{key:1,class:"new-tag tableTag",size:"small",onClick:t=>c.showInput(e.row)},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)(" + New Tag ")])),_:2},1032,["onClick"]))])),_:1}),(0,o.createVNode)(_,{type:"index",label:"#",width:"40px"}),(0,o.createVNode)(_,{label:"参数名称",prop:"attr_name"}),(0,o.createVNode)(_,{label:"操作"},{default:(0,o.withCtx)((e=>[(0,o.createVNode)(g,{type:"primary",icon:n.Edit,size:"small",onClick:t=>c.showEidtParamsDialog(e.row.attr_id)},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)("编辑")])),_:2},1032,["icon","onClick"]),(0,o.createVNode)(g,{type:"danger",icon:n.Delete,size:"small",onClick:t=>c.removeParams(e.row.attr_id)},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)("删除")])),_:2},1032,["icon","onClick"])])),_:1})])),_:1},8,["data"])])),_:1}),(0,o.createVNode)(N,{label:"静态属性",name:"only"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(g,{type:"primary",disabled:3!==n.selectedCateIds.length,onClick:c.showAddParamsdialog},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)("添加属性")])),_:1},8,["disabled","onClick"]),(0,o.createVNode)(x,{data:n.onlyTableData,border:"",stripe:"","row-key":"attr_id"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(_,{type:"expand",width:"40px"},{default:(0,o.withCtx)((e=>[((0,o.openBlock)(!0),(0,o.createElementBlock)(o.Fragment,null,(0,o.renderList)(e.row.attr_vals,((t,a)=>((0,o.openBlock)(),(0,o.createBlock)(w,{class:"tableTag",key:a,closable:"",onClose:t=>c.handleClose(a,e.row)},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)((0,o.toDisplayString)(t),1)])),_:2},1032,["onClose"])))),128)),e.row.inputVisible?((0,o.openBlock)(),(0,o.createBlock)(f,{key:0,ref:"inputRef",modelValue:e.row.inputValue,"onUpdate:modelValue":t=>e.row.inputValue=t,class:"new-tag tableTag",size:"small",onKeyup:(0,o.withKeys)((t=>c.handleInputConfirm(e.row)),["enter"]),onBlur:t=>c.handleInputConfirm(e.row)},null,8,["modelValue","onUpdate:modelValue","onKeyup","onBlur"])):((0,o.openBlock)(),(0,o.createBlock)(g,{key:1,class:"new-tag tableTag",size:"small",onClick:t=>c.showInput(e.row)},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)(" + New Tag ")])),_:2},1032,["onClick"]))])),_:1}),(0,o.createVNode)(_,{type:"index",label:"#",width:"40px"}),(0,o.createVNode)(_,{label:"属性名称",prop:"attr_name"}),(0,o.createVNode)(_,{label:"操作","min-width":"164px"},{default:(0,o.withCtx)((e=>[(0,o.createVNode)(g,{type:"primary",icon:n.Edit,size:"small",onClick:t=>c.showEidtParamsDialog(e.row.attr_id)},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)("编辑")])),_:2},1032,["icon","onClick"]),(0,o.createVNode)(g,{type:"danger",icon:n.Delete,size:"small",onClick:t=>c.removeParams(e.row.attr_id)},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)("删除")])),_:2},1032,["icon","onClick"])])),_:1})])),_:1},8,["data"])])),_:1})])),_:1},8,["modelValue","onTabChange"])])),_:1}),(0,o.createVNode)(F,{modelValue:n.addParamsDialogVisible,"onUpdate:modelValue":t[4]||(t[4]=e=>n.addParamsDialogVisible=e),title:"添加"+c.titleText,width:"50%",onClose:c.addParamsDialogClosed},{footer:(0,o.withCtx)((()=>[(0,o.createElementVNode)("span",d,[(0,o.createVNode)(g,{onClick:t[3]||(t[3]=e=>n.addParamsDialogVisible=!1)},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)("取消")])),_:1}),(0,o.createVNode)(g,{type:"primary",onClick:c.addParams},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)(" 确定 ")])),_:1},8,["onClick"])])])),default:(0,o.withCtx)((()=>[(0,o.createVNode)(k,{ref:"addFormRef",model:n.addForm,rules:n.addFormRules,"label-width":"80px","status-icon":""},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(v,{label:c.titleText,prop:"attr_name"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(f,{modelValue:n.addForm.attr_name,"onUpdate:modelValue":t[2]||(t[2]=e=>n.addForm.attr_name=e)},null,8,["modelValue"])])),_:1},8,["label"])])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title","onClose"]),(0,o.createVNode)(F,{modelValue:n.editParamsDialogVisible,"onUpdate:modelValue":t[7]||(t[7]=e=>n.editParamsDialogVisible=e),title:"修改"+c.titleText,width:"50%",onClose:c.editParamsDialogClosed},{footer:(0,o.withCtx)((()=>[(0,o.createElementVNode)("span",s,[(0,o.createVNode)(g,{onClick:t[6]||(t[6]=e=>n.editParamsDialogVisible=!1)},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)("取消")])),_:1}),(0,o.createVNode)(g,{type:"primary",onClick:c.editParams},{default:(0,o.withCtx)((()=>[(0,o.createTextVNode)(" 确定 ")])),_:1},8,["onClick"])])])),default:(0,o.withCtx)((()=>[(0,o.createVNode)(k,{ref:"editFormRef",model:n.editForm,rules:n.editFormRules,"label-width":"80px","status-icon":""},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(v,{label:c.titleText,prop:"attr_name"},{default:(0,o.withCtx)((()=>[(0,o.createVNode)(f,{modelValue:n.editForm.attr_name,"onUpdate:modelValue":t[5]||(t[5]=e=>n.editForm.attr_name=e)},null,8,["modelValue"])])),_:1},8,["label"])])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title","onClose"])])}a(7658);var c=a(3010),m={data(){return{ArrowRight:c.ArrowRight,Edit:c.Edit,Delete:c.Delete,cateList:[],cascadeProps:{expandTrigger:"hover",label:"cat_name",value:"cat_id",children:"children"},selectedCateIds:[],activeName:"many",manyTableData:[],onlyTableData:[],addParamsDialogVisible:!1,addForm:{},addFormRules:{attr_name:[{required:!0,message:"请输入参数名称",trigger:"blur"}]},editParamsDialogVisible:!1,editForm:{},editFormRules:{attr_name:[{required:!0,message:"请输入参数名称",trigger:"blur"}]}}},created(){this.getCateList()},methods:{getCateList(){this.$api.httpGet("categories",{showOuter:"error"}).then((e=>{this.cateList=e.data}))},handleChange(){this.getParamsData()},handleTabChange(){this.getParamsData()},getParamsData(){if(3!==this.selectedCateIds.length)return this.selectedCateIds=[],this.manyTableData=[],void(this.onlyTableData=[]);this.$api.httpGet("categories/"+this.cateId+"/attributes",{showOuter:!1,error:["获取分类参数失败！"]},200,{params:{sel:this.activeName}}).then((e=>{e.data.forEach((e=>{e.attr_vals=e.attr_vals?e.attr_vals.split(" "):[],e.inputVisible=!1,e.inputValue=""})),"many"===this.activeName?this.manyTableData=e.data:this.onlyTableData=e.data}))},showAddParamsdialog(){this.addParamsDialogVisible=!0},addParamsDialogClosed(){this.$refs.addFormRef.resetFields()},addParams(){this.$refs.addFormRef.validate((e=>{e&&this.$api.httpPost("categories/"+this.cateId+"/attributes",{attr_name:this.addForm.attr_name,attr_sel:this.activeName},{showOuter:"error",success:["添加参数成功！"],error:["添加参数失败！"]},201).then((()=>{this.addParamsDialogVisible=!1,this.getParamsData()}))}))},showEidtParamsDialog(e){this.$api.httpGet(`categories/${this.cateId}/attributes/${e}`,{showOuter:"error",error:["获取参数信息失败！"]},200,{params:{attr_sel:this.activeName}}).then((e=>{this.editForm=e.data,this.editParamsDialogVisible=!0}))},editParamsDialogClosed(){this.editForm={},this.$refs.editFormRef.resetFields()},editParams(){this.$refs.editFormRef.validate((e=>{e&&this.$api.httpPut(`categories/${this.cateId}/attributes/${this.editForm.attr_id}`,{attr_name:this.editForm.attr_name,attr_sel:this.editForm.attr_sel},{showOuter:"error",success:["修改参数成功！"],error:["修改参数失败！"]}).then((()=>{this.editParamsDialogVisible=!1,this.getParamsData()}))}))},removeParams(e){this.$confirm("此操作将永久删除该参数，是否继续？","删除参数",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((()=>this.$api.httpDelete(`categories/${this.cateId}/attributes/${e}`,{error:["删除失败！"]}))).then((()=>{this.getParamsData()})).catch((()=>{this.$message({type:"info",message:"删除取消！",duration:1200})}))},handleInputConfirm(e){if(0===e.inputValue.trim().length)return e.inputValue="",void(e.inputVisible=!1);e.attr_vals.push(e.inputValue.trim()),e.inputValue="",e.inputVisible=!1,this.saveAttrVals(e)},saveAttrVals(e){this.$api.httpPut(`categories/${this.cateId}/attributes/${e.attr_id}`,{attr_name:e.attr_name,attr_sel:e.attr_sel,attr_vals:e.attr_vals.join(" ")},{showOuter:"error",success:["可选项修改成功！"],error:["可选项修改失败！"]})},showInput(e){e.inputVisible=!0,this.$nextTick((()=>{this.$refs.inputRef.$refs.input.focus()}))},handleClose(e,t){t.attr_vals.splice(e,1),this.saveAttrVals(t)}},computed:{cateId(){return 3===this.selectedCateIds.length?this.selectedCateIds[2]:null},titleText(){return"many"===this.activeName?"动态参数":"静态属性"}}},h=a(89);const u=(0,h.Z)(m,[["render",n],["__scopeId","data-v-4f976997"]]);var C=u}}]);
//# sourceMappingURL=cate_params.399f9b18.js.map